---
title: åŸºäºä¹è°±ç”Ÿæˆæ—‹å¾‹è·¯å¾„åŠ¨ç”»ï¼ˆä¸éŸ³ä¹åŒæ­¥æ—¶é—´æ’­æ”¾ï¼‰
tags: []
date: 2023-10-20 10:15:01
---

## èƒŒæ™¯

- åŸºäºä¹è°±çš„éŸ³ç¬¦æ—¶å€¼å’ŒéŸ³é«˜ç”Ÿæˆå¹³æ»‘æ›²çº¿è·¯å¾„
- ä»¥ä¹è°±æ—¶é—´ä¸ºxï¼Œæ²¿è·¯å¾„è¿åŠ¨åŠ¨ç”»

[[anime.js](https://animejs.com/documentation/#motionPath)](https://animejs.com/documentation/#motionPath)

animejsæä¾›äº†svgè·¯å¾„åŠ¨ç”»èƒ½åŠ›ï¼Œsvgçš„ç‚¹åæ ‡æ˜¯åŸºäºè·¯å¾„çš„é•¿åº¦è·å–çš„ï¼Œæ•´ä½“çš„è¿åŠ¨å‡½æ•°æ˜¯çº¿æ€§å‡½æ•°ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼š 

```tsx
f(x,y) = path.getPointAtLength(distance) 
distance = totalLength * t / duration = g(totalLength, t)
f(x,y) = path.getPointAtLength(totalLength * t / duration)
f(x,y) = p(totalLength, t)
```

> æ—¶é—´t0ç‚¹çš„ xåæ ‡ å–å†³äº è·¯å¾„æ€»é•¿åº¦ã€‚ä¸åŒä¹è°±åœ¨ç›¸åŒt0æ—¶é—´ç‚¹çš„xåæ ‡æ˜¯ä¸ä¸€è‡´çš„ã€‚

![image](https://user-images.githubusercontent.com/9689442/178916875-0fa5b1e0-0f87-4c23-a059-649844474d89.png)

> å›¾ä¸­çº¢è‰²ä¸ºåŸºäºè·¯å¾„æ€»é•¿åº¦çš„svgåŠ¨ç”»ï¼Œé»‘è‰²ä¸ºlinearç›´çº¿åŠ¨ç”»ï¼Œå¯ä»¥çœ‹åˆ°åœ¨å½“å‰æ—¶é—´ç‚¹ï¼Œxæ˜¯å¯¹ä¸ä¸Šçš„ã€‚


è€Œæˆ‘ä»¬éœ€è¦çš„éŸ³ä¹è·¯å¾„åŠ¨ç”»ï¼Œæ˜¯æ— è®ºæ˜¯ä»€ä¹ˆä¹è°±ï¼Œåœ¨t0ç‚¹çš„xåæ ‡æ˜¯ä¸€è‡´çš„

å³ï¼š y = pathPoint(x) = g(x)  ; x = maxX * t/duration = f(t); 

```tsx
y = pathPoint(x) = g(x)  
x = maxX * t/ duration
maxX = step * duration
x = step * t 
x = f(t)
```

æˆ–è€…é™çº§ä¸ºï¼šéŸ³ç¬¦å†…ä¸ä¸¥æ ¼ x=f(t), æ¯ä¸ªéŸ³ç¬¦ç»“æŸçš„æ—¶é—´ç‚¹ç¬¦åˆ x = f(t);

## å®ç°æ­£æ¯”äºx|tçš„è·¯å¾„åŠ¨ç”»

åˆ‡åˆ†ä¹è°±çš„æ€»svgè·¯å¾„ï¼Œæ¯ä¸ªéŸ³ç¬¦çš„svgä¸ºä¸€ä¸ªpathï¼Œæ¯ä¸ªpathç”Ÿæˆä¸€ä¸ªè·¯å¾„åŠ¨ç”»ï¼Œduration =  éŸ³ç¬¦æŒç»­æ—¶é—´ï¼Œå…¨éƒ¨åŠ¨ç”»æ‹¼æˆä¸€ä¸ªtimelineï¼Œæ€»æ—¶é•¿= ä¹è°±æ—¶é•¿ï¼Œ ï¼ˆä¸­é—´ä¼‘æ­¢ç¬¦éœ€è¦è¡¥å…¨ç›´çº¿ï¼Ÿï¼‰

![image](https://user-images.githubusercontent.com/9689442/178916875-0fa5b1e0-0f87-4c23-a059-649844474d89.png)

> å›¾ä¸­è“è‰²å—ä¸ºæ¯ä¸ªéŸ³ç¬¦èµ·æ­¢æ—¶é—´ç‚¹ä¸xå¯¹åº”çš„åŠ¨ç”»ï¼ˆéŸ³ç¬¦åŒºé—´å†…xã€tä¸ä¸¥æ ¼å¯¹åº”ï¼‰

demoï¼š

[https://codepen.io/Topppy/pen/dymGGrb](https://codepen.io/Topppy/pen/dymGGrb)

- å—1æ˜¯xçº¿æ€§tçš„ä½ç§»
- å—2æ˜¯ä¸€æ•´æ¡svgè·¯å¾„åŠ¨ç”»
- å—3æ˜¯ä¸¤æ®µpathæ‹¼æ¥çš„ä¸€æ¡svgè·¯å¾„

å—1ä½œä¸ºåŸºå‡†ï¼Œå¯ä»¥çœ‹å‡ºå—2å…¨ç¨‹xéƒ½ä¸å—1æ— æ³•å¯¹é½ï¼Œå—2åœ¨ä¸­é—´ç‚¹å’Œç»“æŸç‚¹æ˜¯å¯¹é½çš„ï¼Œä½†æ˜¯ä¸­é—´çš„ä¸è§„åˆ™è·¯å¾„è·Ÿå—1çš„xä½ç§»æ²¡æœ‰å¯¹é½ï¼Œç‚¹å‡»seek1æŒ‰é’®å®šä½æ—¶é—´åˆ°ä¸­é—´ç‚¹ï¼Œå¯ä»¥æ˜æ˜¾çœ‹å‡ºæ¥ã€‚

å—3æ˜¯å¯ä»¥é™çº§æ»¡è¶³éŸ³ä¹æ—‹å¾‹è·¯å¾„èµ°è°±çš„ã€‚

## æ ¹æ®ä¹è°±ç»˜åˆ¶å¹³æ»‘æ—‹å¾‹è·¯å¾„

ä¹è°±ä¸­éœ€è¦å æ®æ—¶é—´çš„èŠ‚ç‚¹æœ‰ä¸¤ç§

- éŸ³ç¬¦ï¼ˆsvg Cï¼‰
- ä¼‘æ­¢ç¬¦ï¼ˆsvg L/Hï¼‰ï¼Œï¼ˆä¹Ÿå¯ä»¥å¿½ç•¥ä¼‘æ­¢ç¬¦ï¼‰

æ•°æ®å¤„ç†é€»è¾‘ï¼šï¼ˆå…·ä½“å¯ä»¥å‚è€ƒd3ï¼‰

- ~~ç‚¹æ•°æ®ï¼š åˆå¹¶æœ‰åºæ•°ç»„éŸ³ç¬¦ï¼ˆnotesï¼‰ å’Œ ä¼‘æ­¢ç¬¦ï¼ˆrestsï¼‰~~
- Cæ›²çº¿æ§åˆ¶ç‚¹æ•°æ®ï¼š ï¼ˆè¿™é‡Œpercentage = 0.5ï¼‰
    - æ§åˆ¶ç‚¹1:  [x0 + 0.5 * (x1-x0), y0]
    - æ§åˆ¶ç‚¹2:  [x0 + 0.5 * (x1-x0), y1]
- svgPathListï¼š
    - å¦‚æœonset=0çš„ç‚¹ä¸æ˜¯note, éœ€è¦ä»ï¼ˆ0ï¼Œ0ï¼‰å¼€å§‹
    - ç»ˆç‚¹ï¼ˆscore.duration, 0ï¼‰


![IMG_6772](https://user-images.githubusercontent.com/9689442/178715028-ec64e731-fc7b-4379-8e8a-28df7e89abbc.jpg)

æ›²çº¿çš„çš„æ›²ç‡å˜åŒ–

å¯¹ç§°ï¼šp1.x =distance(x1,x2)- p2.x

éå¯¹ç§°ï¼š p1.x = p2.x

ä¹Ÿå¯ä»¥ç‹¬ç«‹æ§åˆ¶ä¸¤ä¸ªæ§åˆ¶ç‚¹çš„xçš„percentage

![IMG_6771](https://user-images.githubusercontent.com/9689442/178714998-b3e4cc27-da83-47ac-b1db-8a23ca85326b.jpg)


æœ€ådemoï¼š

[https://codepen.io/Topppy/pen/JjLGmBd?editors=1010](https://codepen.io/Topppy/pen/JjLGmBd?editors=1010)

## å‚è€ƒ

svgè·¯å¾„ç¼–è¾‘å™¨

[[SvgPathEditor](https://yqnn.github.io/svg-path-editor/)](https://yqnn.github.io/svg-path-editor/)

d3çš„curveæ•ˆæœï¼š[https://github.com/d3/d3-shape/blob/v3.1.0/README.md#curves](https://github.com/d3/d3-shape/blob/v3.1.0/README.md#curves)

d3çš„natural curve æºç :[https://github.com/d3/d3-shape/blob/main/src/curve/natural.js](https://github.com/d3/d3-shape/blob/main/src/curve/natural.js)

web audio è°ƒèŠ‚æ’­æ”¾éŸ³é¢‘çš„éŸ³é«˜ ï¼š [https://zpl.fi/pitch-shifting-in-web-audio-api/](https://zpl.fi/pitch-shifting-in-web-audio-api/)

midiæ–‡ä»¶æ ¼å¼è§£æï¼š[https://www.jianshu.com/p/59d74800b43b](https://www.jianshu.com/p/59d74800b43b)   

 Magentaé­”æ”¹è®°-2ï¼šæ•°æ®æ ¼å¼ä¸æ•°æ®é›†ï¼ˆæ¶‰åŠmidiå’Œmxlæ ¼å¼å¯¹æ¯”[https://zhuanlan.zhihu.com/p/49539387](https://zhuanlan.zhihu.com/p/49539387)

ä¹è°±æ¸²æŸ“ï¼šhttps://github.com/0xfe/vexflow

mxlä¹è°±æ¸²æŸ“ï¼šhttps://github.com/opensheetmusicdisplay/opensheetmusicdisplayddemo

demoé¡µï¼š[https://opensheetmusicdisplay.org/demos/public-typescript-demo/](https://opensheetmusicdisplay.org/demos/public-typescript-demo/)

â¤ï¸â€ğŸ”¥åŸºäºæœºå™¨å­¦ä¹ çš„è‡ªåŠ¨ä½œæ›²ï¼š[https://magenta.tensorflow.org/](https://magenta.tensorflow.org/)

[https://magenta.tensorflow.org/demos/web/](https://magenta.tensorflow.org/demos/web/)

[https://github.com/magenta/magenta](https://github.com/magenta/magenta)

music21 æŒ‡å—ï¼šè®¡ç®—éŸ³ä¹å­¦åˆ†æpythonåº“ï¼š[[https://github.com/lukewys/Magenta-Modification/blob/master/Music21ç®€æ˜æŒ‡å—.ipynb](https://github.com/lukewys/Magenta-Modification/blob/master/Music21%E7%AE%80%E6%98%8E%E6%8C%87%E5%8D%97.ipynb)](https://github.com/lukewys/Magenta-Modification/blob/master/Music21%E7%AE%80%E6%98%8E%E6%8C%87%E5%8D%97.ipynb)
